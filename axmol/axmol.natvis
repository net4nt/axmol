<?xml version="1.0" encoding="utf-8"?>
<AutoVisualizer xmlns="http://schemas.microsoft.com/vstudio/debugger/natvis/2010">
    <!-- flat_set_base visualizer -->
    <Type Name="tlx::flat_set_base&lt;*&gt;">
        <DisplayString>{{size = {_Mycont._Mypair._Myval2._Mylast - _Mycont._Mypair._Myval2._Myfirst}}}</DisplayString>
        <Expand>
            <Item Name="[comparator]" ExcludeView="simple">_Mycomp</Item>
            <Item Name="[size]">_Mycont._Mypair._Myval2._Mylast - _Mycont._Mypair._Myval2._Myfirst</Item>
            <Item Name="[capacity]" ExcludeView="simple">_Mycont._Mypair._Myval2._Myend - _Mycont._Mypair._Myval2._Myfirst</Item>
            <ArrayItems>
                <Size>_Mycont._Mypair._Myval2._Mylast - _Mycont._Mypair._Myval2._Myfirst</Size>
                <ValuePointer>_Mycont._Mypair._Myval2._Myfirst</ValuePointer>
            </ArrayItems>
        </Expand>
    </Type>


    <!-- Visualize tlx::detail::flat_map_base<_Traits> -->
    <!-- KeyContainer: vector, MappedContainer: vector -->
    <Type Name="tlx::flat_map&lt;*,*,*,std::vector&lt;*&gt;,std::vector&lt;*&gt;&gt;">
        <Intrinsic Name="size" Expression="(size_t)(_Mykeys._Mypair._Myval2._Mylast - _Mykeys._Mypair._Myval2._Myfirst)"/>
        <Intrinsic Name="key_at" Expression="&amp;_Mykeys._Mypair._Myval2._Myfirst[index]">
            <Parameter Name="index" Type="size_t" />
        </Intrinsic>
        <Intrinsic Name="value_at" Expression="&amp;_Myvals._Mypair._Myval2._Myfirst[index]">
            <Parameter Name="index" Type="size_t" />
        </Intrinsic>

        <DisplayString>{{ size={size()} }}</DisplayString>

        <Expand>
            <Item Name="[comparator]" ExcludeView="simple">_Key_compare</Item>
            <Item Name="[size]">size()</Item>
            <CustomListItems>
                <Variable Name="i" InitialValue="0" />
                <Size>size()</Size>
                <Loop>
                    <Item Name="[{*key_at(i)}]">*value_at(i)</Item>
                    <Exec>++i</Exec>
                </Loop>
            </CustomListItems>
        </Expand>
    </Type>

    <!-- KeyContainer: std::deque, MappedContainer: std::vector -->
    <Type Name="tlx::flat_map&lt;*,*,*,std::deque&lt;*&gt;,std::vector&lt;*&gt;&gt;">
        <Intrinsic Name="size" Expression="_Mykeys._Mypair._Myval2._Mysize" />
        <Intrinsic Name="key_at" Expression="&amp;_Mykeys._Mypair._Myval2._Map[((index + _Mykeys._Mypair._Myval2._Myoff) / _Mykeys._EEN_DS) %
          _Mykeys._Mypair._Myval2._Mapsize][(index + _Mykeys._Mypair._Myval2._Myoff) % _Mykeys._EEN_DS]">
            <Parameter Name="index" Type="size_t" />
        </Intrinsic>
        <Intrinsic Name="value_at" Expression="&amp;_Myvals._Mypair._Myval2._Myfirst[index]">
            <Parameter Name="index" Type="size_t" />
        </Intrinsic>

        <DisplayString>{{ size={size()} }}</DisplayString>

        <Expand>
            <Item Name="[comparator]" ExcludeView="simple">_Key_compare</Item>
            <Item Name="[size]">size()</Item>
            <CustomListItems>
                <Variable Name="i" InitialValue="0" />
                <Size>size()</Size>
                <Loop>
                    <Item Name="[{*key_at(i)}]">*value_at(i)</Item>
                    <Exec>++i</Exec>
                </Loop>
            </CustomListItems>
        </Expand>
    </Type>

    <!-- KeyContainer: std::vector, MappedContainer: std::deque -->
    <Type Name="tlx::flat_map&lt;*,*,*,std::vector&lt;*&gt;,std::deque&lt;*&gt;&gt;">
        <Intrinsic Name="size" Expression="(size_t)(_Mykeys._Mypair._Myval2._Mylast - _Mykeys._Mypair._Myval2._Myfirst)" />
        <Intrinsic Name="key_at" Expression="&amp;_Mykeys._Mypair._Myval2._Myfirst[index]">
            <Parameter Name="index" Type="size_t" />
        </Intrinsic>
        <Intrinsic Name="value_at" Expression="&amp;_Myvals._Mypair._Myval2._Map[((index + _Myvals._Mypair._Myval2._Myoff) / _Myvals._EEN_DS) %
          _Myvals._Mypair._Myval2._Mapsize][(index + _Myvals._Mypair._Myval2._Myoff) % _Myvals._EEN_DS]">
            <Parameter Name="index" Type="size_t" />
        </Intrinsic>

        <DisplayString>{{ size={size()} }}</DisplayString>

        <Expand>
            <Item Name="[comparator]" ExcludeView="simple">_Key_compare</Item>
            <Item Name="[size]">size()</Item>
            <CustomListItems>
                <Variable Name="i" InitialValue="0" />
                <Size>size()</Size>
                <Loop>
                    <Item Name="[{*key_at(i)}]">*value_at(i)</Item>
                    <Exec>++i</Exec>
                </Loop>
            </CustomListItems>
        </Expand>
    </Type>

    <!-- KeyContainer: std::deque, MappedContainer: std::deque -->
    <Type Name="tlx::flat_map&lt;*,*,*,std::deque&lt;*&gt;,std::deque&lt;*&gt;&gt;">
        <Intrinsic Name="size" Expression="_Mykeys._Mypair._Myval2._Mysize" />
        <Intrinsic Name="key_at" Expression="&amp;_Mykeys._Mypair._Myval2._Map[((index + _Mykeys._Mypair._Myval2._Myoff) / _Mykeys._EEN_DS) %
          _Mykeys._Mypair._Myval2._Mapsize][(index + _Mykeys._Mypair._Myval2._Myoff) % _Mykeys._EEN_DS]">
            <Parameter Name="index" Type="size_t" />
        </Intrinsic>
        <Intrinsic Name="value_at" Expression="&amp;_Myvals._Mypair._Myval2._Map[((index + _Myvals._Mypair._Myval2._Myoff) / _Myvals._EEN_DS) %
          _Myvals._Mypair._Myval2._Mapsize][(index + _Myvals._Mypair._Myval2._Myoff) % _Myvals._EEN_DS]">
            <Parameter Name="index" Type="size_t" />
        </Intrinsic>

        <DisplayString>{{ size={size()} }}</DisplayString>

        <Expand>
            <Item Name="[comparator]" ExcludeView="simple">_Key_compare</Item>
            <Item Name="[size]">size()</Item>
            <CustomListItems>
                <Variable Name="i" InitialValue="0" />
                <Size>size()</Size>
                <Loop>
                    <Item Name="[{*key_at(i)}]">*value_at(i)</Item>
                    <Exec>++i</Exec>
                </Loop>
            </CustomListItems>
        </Expand>
    </Type>

    <!-- fallback for a custom container -->
    <Type Name="tlx::flat_map_base&lt;*&gt;">
        <DisplayString>{_Data}</DisplayString>
        <Expand>
            <Item Name="[comparator]" ExcludeView="simple">_Key_compare</Item>
            <Item Name="[keys]">_Mykeys</Item>
            <Item Name="[values]">_Myvals</Item>
        </Expand>
    </Type>

    <!-- iterator -->
    <Type Name="tlx::flat_map_base&lt;*&gt;::iterator">
        <DisplayString>({_Key_it}, {_Mapped_it})</DisplayString>
        <Expand>
            <Item Name="[key]">_Key_it</Item>
            <Item Name="[value]">_Mapped_it</Item>
        </Expand>
    </Type>

    <!-- const_iterator -->
    <Type Name="tlx::flat_map_base&lt;*&gt;::const_iterator">
        <DisplayString>({_Key_it}, {_Mapped_it})</DisplayString>
        <Expand>
            <Item Name="[key]">_Key_it</Item>
            <Item Name="[value]">_Mapped_it</Item>
        </Expand>
    </Type>
</AutoVisualizer>
